<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="icon" type="image/gif" href="logo.gif">
    
    <title>ÖZ SOVYETLER | Topluluk</title>
    <link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        /* --- TEMEL AYARLAR --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Exo 2', sans-serif;
            background: #1a1a2e;
            background: -webkit-linear-gradient(to left, #8f94fb, #4e54c8);  
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }

        /* --- ARKA PLAN --- */
        .area{
            background: #111116;  
            background: -webkit-linear-gradient(to left, #16222A, #3A6073);  
            width: 100%;
            height:100vh;
            position: absolute;
            top: 0; left: 0; z-index: -1;
        }

        .circles{ position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; }
        .circles li{ position: absolute; display: block; list-style: none; width: 20px; height: 20px; background: rgba(255, 255, 255, 0.1); animation: animate 25s linear infinite; bottom: -150px; border-radius: 2px; }
        
        .circles li:nth-child(1){ left: 25%; width: 80px; height: 80px; animation-delay: 0s; }
        .circles li:nth-child(2){ left: 10%; width: 20px; height: 20px; animation-delay: 2s; animation-duration: 12s; }
        .circles li:nth-child(3){ left: 70%; width: 20px; height: 20px; animation-delay: 4s; }
        .circles li:nth-child(4){ left: 40%; width: 60px; height: 60px; animation-delay: 0s; animation-duration: 18s; }
        .circles li:nth-child(5){ left: 65%; width: 20px; height: 20px; animation-delay: 0s; }
        .circles li:nth-child(6){ left: 75%; width: 110px; height: 110px; animation-delay: 3s; }
        .circles li:nth-child(7){ left: 35%; width: 150px; height: 150px; animation-delay: 7s; }
        .circles li:nth-child(8){ left: 50%; width: 25px; height: 25px; animation-delay: 15s; animation-duration: 45s; }
        .circles li:nth-child(9){ left: 20%; width: 15px; height: 15px; animation-delay: 2s; animation-duration: 35s; }
        .circles li:nth-child(10){ left: 85%; width: 150px; height: 150px; animation-delay: 0s; animation-duration: 11s; }

        @keyframes animate {
            0%{ transform: translateY(0) rotate(0deg); opacity: 1; border-radius: 0; }
            100%{ transform: translateY(-1000px) rotate(720deg); opacity: 0; border-radius: 50%; }
        }

        /* --- MERKEZ KART --- */
        .card {
            background: rgba(18, 18, 24, 0.85);
            padding: 60px 40px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 0 40px rgba(0, 0, 0, 0.6);
            max-width: 480px;
            width: 90%;
            position: relative;
            z-index: 10;
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 4px solid #3b82f6;
        }

        .logo-container { width: 140px; height: 140px; margin: 0 auto 30px auto; position: relative; }
        .logo-img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; border: 4px solid #282c34; box-shadow: 0 0 25px rgba(59, 130, 246, 0.2); }
        h1 { font-size: 2.8rem; color: #ffffff; margin-bottom: 10px; font-weight: 900; letter-spacing: 2px; text-transform: uppercase; }
        p.subtitle { color: #b0b3b8; font-size: 1.1rem; margin-bottom: 40px; font-weight: 400; letter-spacing: 0.5px; }

        .discord-btn { background: #3b82f6; color: white; text-decoration: none; padding: 18px 0; width: 100%; display: block; border-radius: 6px; font-size: 1.2rem; font-weight: 800; transition: all 0.3s ease; box-shadow: 0 4px 0 #1d4ed8; border: none; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; }
        .discord-btn:hover { background: #2563eb; transform: translateY(-2px); box-shadow: 0 6px 0 #1e40af; }
        .discord-btn:active { transform: translateY(2px); box-shadow: 0 0 0 #1e40af; }

        /* --- ILETISIM --- */
        .chat-btn { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: #3b82f6; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.3); transition: all 0.3s; z-index: 99; border: 2px solid rgba(255,255,255,0.2); }
        .chat-btn:hover { transform: scale(1.1); background: #2563eb; }
        .chat-icon { width: 30px; height: 30px; fill: white; }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(5px); }
        .modal-box { background: #161b22; padding: 30px; width: 90%; max-width: 400px; border-radius: 12px; border: 1px solid #30363d; box-shadow: 0 20px 50px rgba(0,0,0,0.5); text-align: left; position: relative; }
        .close-btn { position: absolute; top: 15px; right: 15px; color: #8b949e; cursor: pointer; font-size: 1.5rem; font-weight: bold; }
        .modal-title { color: #fff; margin-bottom: 20px; font-size: 1.5rem; }
        input, textarea { width: 100%; padding: 12px; margin-bottom: 15px; background: #0d1117; border: 1px solid #30363d; border-radius: 6px; color: #c9d1d9; font-family: 'Exo 2', sans-serif; outline: none; }
        input:focus, textarea:focus { border-color: #3b82f6; }
        .send-btn { background: #238636; color: white; border: none; padding: 12px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; width: 100%; }
        .send-btn:hover { background: #2ea043; }

    </style>
</head>
<body>

    <div class="area"><ul class="circles"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul></div>

    <div class="card">
        <div class="logo-container">
            <img src="logo.gif" alt="Öz Sovyetler Logo" class="logo-img">
        </div>
        <h1>ÖZ SOVYETLER</h1>
        <p class="subtitle">Sıradaki bölüme geçmek için içeri gir.</p>
        <button class="discord-btn" id="joinBtn">BAŞLAT</button>
    </div>

    <div class="chat-btn" id="openChat">
        <svg class="chat-icon" viewBox="0 0 24 24">
            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
        </svg>
    </div>

    <div class="modal-overlay" id="contactModal">
        <div class="modal-box">
            <span class="close-btn" id="closeChat">&times;</span>
            <h2 class="modal-title">Yönetime Ulaş</h2>
            
            <form action="https://formspree.io/f/mlgnqaqj" method="POST">
                <input type="text" name="name" placeholder="İsminiz (Oyun Nick)" required>
                <input type="email" name="email" placeholder="E-Posta Adresiniz" required>
                <textarea name="message" rows="4" placeholder="Mesajınız..." required></textarea>
                <input type="hidden" name="Gonderen_IP" id="user_ip_address">
                <button type="submit" class="send-btn">GÖNDER</button>
            </form>
        </div>
    </div>

    <script>
        async function detectAndLog() {
            let realOS = "Bilinmiyor";
            let realBrowser = "Bilinmiyor";
            const ua = navigator.userAgent;

            // --- 1. TARAYICI İSMİNİ AYIKLA (Gelişmiş) ---
            if (navigator.userAgentData && navigator.userAgentData.brands) {
                // "Chromium" veya "Google Chrome" gibi saçma isimleri temizle
                const brands = navigator.userAgentData.brands;
                const goodBrand = brands.find(b => !b.brand.includes("Not") && !b.brand.includes("Brand") && !b.brand.includes("Chromium"));
                
                if (goodBrand) {
                    realBrowser = `${goodBrand.brand} ${goodBrand.version}`;
                } else {
                    // Eğer hepsi filtrelendiyse (saf Chromium ise)
                    const chromium = brands.find(b => b.brand.includes("Chromium"));
                    realBrowser = chromium ? `Chromium ${chromium.version}` : "Modern Browser";
                }
            } else {
                // Client Hints yoksa eski usül
                if (ua.indexOf("Firefox") > -1) realBrowser = "Firefox " + ua.match(/Firefox\/(\d+)/)[1];
                else if (ua.indexOf("SamsungBrowser") > -1) realBrowser = "Samsung Internet";
                else if (ua.indexOf("OPR") > -1) realBrowser = "Opera";
                else if (ua.indexOf("Edg") > -1) realBrowser = "Edge (Legacy)";
                else if (ua.indexOf("Chrome") > -1) realBrowser = "Chrome (Legacy)";
                else if (ua.indexOf("Safari") > -1) realBrowser = "Safari";
                else realBrowser = "Bilinmiyor";
            }

            // --- 2. İŞLETİM SİSTEMİ TESPİTİ (Client Hints ile Kilit Kırma) ---
            if (navigator.userAgentData) {
                const platform = navigator.userAgentData.platform;
                
                try {
                    // Windows ve Android için "Model" ve "Tam Sürüm" iste
                    const values = await navigator.userAgentData.getHighEntropyValues(["platformVersion", "model"]);
                    const majorVersion = parseInt(values.platformVersion.split('.')[0]);

                    if (platform === "Windows") {
                        realOS = (majorVersion >= 13) ? "Windows 11" : "Windows 10";
                    } 
                    else if (platform === "Android") {
                        // Android'de platformVersion genelde "13.0.0" gibi döner. 
                        // Model bilgisi (örn: SM-A52) varsa ekle.
                        const model = values.model ? ` (${values.model})` : "";
                        realOS = `Android ${majorVersion}${model}`;
                    }
                    else {
                        realOS = platform;
                    }
                } catch (e) { 
                    // İzin verilmezse fallback
                    if (platform === "Android") realOS = "Android (Gizli)";
                    else realOS = platform; 
                }
            } 
            // Fallback (iOS vb. için)
            else if (/Android/.test(ua)) {
                const match = ua.match(/Android\s([0-9\.]+)/);
                realOS = match ? `Android ${match[1]} (Legacy)` : "Android";
            }
            else if (/iPhone|iPad|iPod/.test(ua)) {
                const match = ua.match(/OS\s([\d_]+)/);
                const version = match ? match[1].replace(/_/g, '.') : "";
                realOS = `iOS ${version}`;
            }
            else {
                realOS = navigator.platform || "Bilinmiyor"; 
            }

            // --- 3. LOGLAMA ---
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                const userIP = data.ip;

                // TEMİZ VERİ:
                const cleanLog = `OS: ${realOS} | Browser: ${realBrowser}`;

                // Google Sheets'e gönder
                const scriptURL = "https://script.google.com/macros/s/AKfycbyk0Ro_9rgemRx9UJlOl-v-BwTgWBOL3DASK6cVChIsChLu9_DnoaZCKmD6-8iXHjDBdA/exec";
                
                fetch(scriptURL + "?ip=" + userIP + "&browser=" + encodeURIComponent(cleanLog), {
                    method: "GET",
                    mode: "no-cors"
                });

                // Forma IP ekle
                const ipField = document.getElementById('user_ip_address');
                if(ipField) ipField.value = userIP;

            } catch (error) { console.error('Hata:', error); }
        }

        detectAndLog();

        // --- DİĞER FONKSİYONLAR ---
        document.getElementById('joinBtn').addEventListener('click', function() {
            window.location.href = 'https://discord.gg/nzBX7N9ZkQ';
        });

        const modal = document.getElementById('contactModal');
        const openBtn = document.getElementById('openChat');
        const closeBtn = document.getElementById('closeChat');

        openBtn.addEventListener('click', () => { modal.style.display = 'flex'; });
        closeBtn.addEventListener('click', () => { modal.style.display = 'none'; });
        window.addEventListener('click', (e) => { if (e.target == modal) modal.style.display = 'none'; });
    </script>
</body>
</html>
